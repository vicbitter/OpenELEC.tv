From d2e4acfd41735cf68d23e7777c50eade37b3abd9 Mon Sep 17 00:00:00 2001
From: Voyager1 <voyager@xbmc.org>
Date: Sat, 13 Apr 2013 15:38:10 +0200
Subject: [PATCH] ffmpeg 1.2 - fixed dvd still frames ended up in internal lavf

---
 libavformat/utils.c                     |  2 +-

diff --git a/libavformat/utils.c b/libavformat/utils.c
index c3bd3d9..72f59d2 100644
--- a/libavformat/utils.c
+++ b/libavformat/utils.c
@@ -706,7 +706,7 @@ static void probe_codec(AVFormatContext *s, AVStream *st, const AVPacket *pkt)
 
         if(end || av_log2(pd->buf_size) != av_log2(pd->buf_size - pkt->size)){
             int score= set_codec_from_probe_data(s, st, pd);
-            if(    (st->codec->codec_id != AV_CODEC_ID_NONE && score > AVPROBE_SCORE_RETRY)
+            if(    (st->codec->codec_id != AV_CODEC_ID_NONE && score > AVPROBE_SCORE_RETRY-1)
                 || end){
                 pd->buf_size=0;
                 av_freep(&pd->buf);
-- 
1.8.1.5

