From 68bc1ebde127d94cf2ab22d1c81d7393f8514945 Mon Sep 17 00:00:00 2001
From: vicbitter <xbmcvb@gmail.com>
Date: Wed, 10 Apr 2013 07:09:59 +0100
Subject: [PATCH] ffmpeg forward compatibility fix for matroska embedded
 subtitles

---
 xbmc/cores/dvdplayer/DVDCodecs/DVDFactoryCodec.cpp             |    1 +
 xbmc/cores/dvdplayer/DVDCodecs/Overlay/DVDOverlayCodecText.cpp |    2 ++
 2 files changed, 3 insertions(+)

diff --git a/xbmc/cores/dvdplayer/DVDCodecs/DVDFactoryCodec.cpp b/xbmc/cores/dvdplayer/DVDCodecs/DVDFactoryCodec.cpp
index 6d0d9eb..68fe109 100644
--- a/xbmc/cores/dvdplayer/DVDCodecs/DVDFactoryCodec.cpp
+++ b/xbmc/cores/dvdplayer/DVDCodecs/DVDFactoryCodec.cpp
@@ -353,6 +353,7 @@ CDVDOverlayCodec* CDVDFactoryCodec::CreateOverlayCodec( CDVDStreamInfo &hint )
   switch (hint.codec)
   {
     case CODEC_ID_TEXT:
+    case AV_CODEC_ID_SUBRIP:
       pCodec = OpenCodec(new CDVDOverlayCodecText(), hint, options);
       if( pCodec ) return pCodec;
       break;
diff --git a/xbmc/cores/dvdplayer/DVDCodecs/Overlay/DVDOverlayCodecText.cpp b/xbmc/cores/dvdplayer/DVDCodecs/Overlay/DVDOverlayCodecText.cpp
index 108284b..4615d79 100644
--- a/xbmc/cores/dvdplayer/DVDCodecs/Overlay/DVDOverlayCodecText.cpp
+++ b/xbmc/cores/dvdplayer/DVDCodecs/Overlay/DVDOverlayCodecText.cpp
@@ -44,6 +44,8 @@ bool CDVDOverlayCodecText::Open(CDVDStreamInfo &hints, CDVDCodecOptions &options
   m_bIsSSA = (hints.codec == CODEC_ID_SSA);
   if(hints.codec == CODEC_ID_TEXT || hints.codec == CODEC_ID_SSA)
     return true;
+  if(hints.codec == AV_CODEC_ID_SUBRIP)
+    return true;
   return false;
 }
 
-- 
1.7.10.4

